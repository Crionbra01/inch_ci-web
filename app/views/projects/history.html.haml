= render :layout => "page" do
  .repo-info
    .explanation
      %p
        Here you can see the
        %strong history
        of your project.
      %p
        Objects that would not appear under 'Evaluation' like private methods are omitted.

    .table-responsive
      - @diffs.each do |rev_diff|
        - if rev_diff.change_count > 0
          .revision_diff
            %h3.sub-header= rev_diff.revision.authored_at.strftime("%a, %Y-%m-%d")
            = rev_diff.revision.uid
            - rev_diff.changes.each do |key, list|
              - if list.size > 0
                = list.size
                = key

            - list = rev_diff.changes['degraded']
            - if list.size > 0
              %table.table.table-striped.grade-table.grade-table-C
                %thead
                  %tr
                    %th{:colspan => 3} DEGRADED
                - list.each do |code_object_diff|
                  - code_object = @code_object_map[code_object_diff.after_object_id]
                  %tr
                    %td.grade
                      .grade-circle{:class => "grade-circle-#{code_object.grade}", :title => t("grade_list_table.grade_icon_hint")}
                        = code_object.grade
                    %td.fullname
                      = code_object.fullname
                    %td.priority
                      = image_tag "priority/#{code_object.priority_symbol}.png", :title => t("grade_list_table.priority_icon_hint")

            - list = rev_diff.changes['improved']
            - if list.size > 0
              %table.table.table-striped.grade-table.grade-table-A
                %thead
                  %tr
                    %th{:colspan => 3} IMPROVED
                - list.each do |code_object_diff|
                  - code_object = @code_object_map[code_object_diff.after_object_id]
                  %tr
                    %td.grade
                      .grade-circle{:class => "grade-circle-#{code_object.grade}", :title => t("grade_list_table.grade_icon_hint")}
                        = code_object.grade
                    %td.fullname
                      = code_object.fullname
                    %td.priority
                      = image_tag "priority/#{code_object.priority_symbol}.png", :title => t("grade_list_table.priority_icon_hint")

            - list = rev_diff.changes['added']
            - if list.size > 0
              %table.table.table-striped.grade-table.grade-table-added
                %thead
                  %tr
                    %th{:colspan => 3} ADDED
                - list.each do |code_object_diff|
                  - code_object = @code_object_map[code_object_diff.after_object_id]
                  %tr
                    %td.grade
                      .grade-circle{:class => "grade-circle-#{code_object.grade}", :title => t("grade_list_table.grade_icon_hint")}
                        = code_object.grade
                    %td.fullname
                      = code_object.fullname
                    %td.priority
                      = image_tag "priority/#{code_object.priority_symbol}.png", :title => t("grade_list_table.priority_icon_hint")

  = render "about_footer"
